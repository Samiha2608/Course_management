<div class="card">
  <div class="card-header">
    <h2><%= @student.name %></h2>
  </div>
  <div class="card-body">
    <p class="card-text"><strong>Email:</strong> <%= @student.email %></p>
    <p class="card-text"><strong>Phone:</strong> <%= @student.phone_no %></p>
    <p class="card-text"><strong>Address:</strong> <%= @student.address %></p>
    <%= link_to "Back", admin_students_path, class: "btn btn-secondary" %>
  </div>

  <%= form_with model: [ :admin, @student, Comment.new ], local: true do |f| %>
    <div class="card-body border-top">
      <div class="mb-3">
        <%= f.text_area :content, placeholder: "Write a comment...", class: "form-control", rows: 3 %>
      </div>
      <%= f.submit "Add Comment", class: "btn btn-primary" %>
    </div>
  <% end %>

  <ul class="list-group list-group-flush">
    <% @student.comments.each do |comment| %>
      <li class="list-group-item">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <p class="mb-1"><%= comment.content %></p>
            <small class="text-muted">by <%= comment.author.name %></small>
          </div>
          
          <% if comment.author == current_user || current_user.is_a?(Admin) %>
            <div class="btn-group btn-group-sm">
              <%= link_to "Edit", edit_admin_student_comment_path(@student, comment), class: "btn btn-outline-secondary btn-sm" %>
              <%= button_to "Delete", admin_student_comment_path(@student, comment),
                  class: "btn btn-danger btn-sm",
                  method: :delete, 
                  data: { confirm: "Are you sure?" } %>
            </div>
          <% end %>
        </div>
      </li>
    <% end %>
    
    <% if @student.comments.empty? %>
      <li class="list-group-item text-muted text-center">No comments yet.</li>
    <% end %>
  </ul>
</div>